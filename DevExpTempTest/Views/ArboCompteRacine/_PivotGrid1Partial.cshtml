@using DevExpress.Web;
@using DevExpress.Web.Mvc;
@using DevExpress.XtraPivotGrid;
@using DevExpress.XtraPivotGrid.Customization;




@Html.DevExpress().PivotGrid(settings =>
{
    settings.Name = "ArboCompteRacinePivotGrid";
    settings.CallbackRouteValues = new { Controller = "ArboCompteRacine", Action = "PivotGrid1Partial" };





    settings.PreRender = (sender, e) =>
    {
        ASPxPivotGrid PivotGrid = sender as ASPxPivotGrid;
        MemoryStream collapseStateStream = (MemoryStream)(Session["ArboCompteRacineMemorySteam"]);
        string layout = (string)(Session["ArboCompteRacineLayout"]);
        if (layout == null ||
            collapseStateStream == null)
        {
            return;
        }
        PivotGrid.LoadLayoutFromString(layout, PivotGridWebOptionsLayout.DefaultLayout);
        collapseStateStream.Seek(0, SeekOrigin.Begin);
        PivotGrid.LoadCollapsedStateFromStream(collapseStateStream);
    };
    settings.AfterPerformCallback = (sender, e) =>
    {
        ASPxPivotGrid PivotGrid = sender as ASPxPivotGrid;
        Session["ArboCompteRacineLayout"] = PivotGrid.SaveLayoutToString(PivotGridWebOptionsLayout.DefaultLayout);
        MemoryStream collapseStateStream = (MemoryStream)(Session["ArboCompteRacineMemorySteam"]);
        if (collapseStateStream != null)
        {
            collapseStateStream.Dispose();
        }
        collapseStateStream = new MemoryStream();
        PivotGrid.SaveCollapsedStateToStream(collapseStateStream);
        Session["ArboCompteRacineMemorySteam"] = collapseStateStream;
    };





    settings.OptionsCustomization.CustomizationFormLayout = CustomizationFormLayout.StackedSideBySide;

    settings.Width = Unit.Percentage(100);
    settings.Height = Unit.Pixel(600);

    settings.OptionsView.VerticalScrollingMode = PivotScrollingMode.Virtual;
    settings.OptionsView.HorizontalScrollingMode = PivotScrollingMode.Virtual;
    settings.OptionsView.VerticalScrollBarMode = ScrollBarMode.Auto;
    settings.OptionsView.HorizontalScrollBarMode = ScrollBarMode.Auto;

    //settings.OptionsView.RowTotalsLocation = PivotRowTotalsLocation.Tree;
    //settings.OptionsView.ShowTotalsForSingleValues = true;


    settings.OptionsView.ShowFilterHeaders = true;
    settings.OptionsCustomization.CustomizationWindowHeight = 150;
    settings.OptionsCustomization.CustomizationWindowWidth = 50;
    settings.OptionsCustomization.CustomizationFormStyle = CustomizationFormStyle.Excel2007;



    settings.OptionsView.GroupFieldsInCustomizationWindow = true;

    settings.ClientSideEvents.CellClick = "function(sender, e) { window.alert('Row index: '+ e.RowIndex) }";

    settings.OptionsPager.RowsPerPage = 100000;
    settings.OptionsPager.ColumnsPerPage = 15;
    settings.OptionsPager.Visible = false;
    settings.OptionsFilter.NativeCheckBoxes = true;




    //Arbo Compte Racine

    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "id";
        field.Caption = "CompteRacine id";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "Niv1";
        field.Caption = "CompteRacine Niv1";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "Niv2";
        field.Caption = "CompteRacine Niv2";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "Niv3";
        field.Caption = "CompteRacine Niv3";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "Niv4";
        field.Caption = "CompteRacine Niv4";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "Niv5";
        field.Caption = "CompteRacine Niv5";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "Niv6";
        field.Caption = "CompteRacine Niv6";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "Niv7";
        field.Caption = "CompteRacine Niv7";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "Niv8";
        field.Caption = "CompteRacine Niv8";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "Niv9";
        field.Caption = "CompteRacine Niv9";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "Niv10";
        field.Caption = "CompteRacine Niv10";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "Code";
        field.Caption = "CompteRacine Code";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });

    //Compte Feuille
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "Code_CF";
        field.Caption = "Compte Feuille Code";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "Libelle";
        field.Caption = "Compte Feuille Libelle";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "CodeCompteRacineParent";
        field.Caption = "Compte Feuille CodeCompteRacineParent";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "TypeTiers";
        field.Caption = "Compte Feuille TypeTiers";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "CodeTiers";
        field.Caption = "Compte Feuille CodeTiers";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "AdresseLogique";
        field.Caption = "Compte Feuille AdresseLogique";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "AdressePhysique";
        field.Caption = "Compte Feuille AdressePhysique";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "Journal";
        field.Caption = "Compte Feuille Journal_Id";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "CategorieTiers";
        field.Caption = "Compte Feuille CategorieTiers";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });

    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "CompteComptable";
        field.Caption = "Compte Feuille CompteComptable";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });

    //Arbo Journal

    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "AJ_id";
        field.Caption = "Journal Id";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "AJ_Label";
        field.Caption = "Journal d'activité";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "AJ_LabelCategorieRegleComptable";
        field.Caption = "Journal LabelCategorieRegleComptable";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });

    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "AJ_Niv1";
        field.Caption = "Journal Niv1";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "AJ_Niv2";
        field.Caption = "Journal Niv2";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "AJ_Niv3";
        field.Caption = "Journal Niv3";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "AJ_Niv4";
        field.Caption = "Journal Niv4";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "AJ_Niv5";
        field.Caption = "Journal Niv5";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });
    settings.Fields.Add(field =>
    {
        field.Area = PivotArea.FilterArea;
        field.FieldName = "AJ_Niv6";
        field.Caption = "Journal Niv6";
        field.Visible = false;
		field.CollapseAll();
        field.ValueStyle.VerticalAlign = VerticalAlign.Top;
    });

}).Bind(Model).GetHtml()